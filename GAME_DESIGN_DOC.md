# 文明：奥德赛 (Civilization: Odyssey) - 核心设计文档

> **版本**: v2.0.0 (Phase 2: 王国时代 - 初期)
> **状态**: 活跃开发中 (Active Development)
> **最后更新**: 2026-01-09

---

## 1. 核心愿景：范式转移 (The Paradigm Shift)

本作核心在于**“时代更迭”**。随着文明演进，旧的机制会退居幕后，新的机制取而代之。

| 时代            | 状态        | 核心主题             | 关键资源         | 玩法特征                   |
| :-------------- | :---------- | :------------------- | :--------------- | :------------------------- |
| **Era 1: 部落** | ✅ 完成     | **生存 (Survival)**  | 食物、木材、传统 | 微操、季节对抗、篝火叙事   |
| **Era 2: 王国** | 🚀 **当前** | **秩序 (Order)**     | 黄金、铁、幸福度 | 宏观税收、社会分级、产业链 |
| **Era 3: 帝国** | 📅 规划     | **征服 (Conquest)**  | 石油、领土、战力 | 地缘政治、后勤、全面战争   |
| **Era 4: 星际** | 📅 规划     | **飞升 (Transcend)** | 能量、暗物质     | 物理法则修改、巨构建筑     |

---

## 2. 当前机制手册 (Phase 2: 王国时代)

_核心关注点从“人与自然”转移到“人与社会”。_

### 2.1 经济引擎：税收与黄金

Era 2 的核心驱动力是 **黄金 (Gold)**，它无法直接采集，必须通过治理获得。

- **税收公式**: `黄金收入 = 总人口 * 税率 (Tax Rate)`
- **制衡机制**:
  - **幸福度 (Happiness)**: 范围 0-100%。税率越高，幸福度越低。
  - **惩罚**:
    - 幸福度 < 50%: 全局产出效率线性下降。
    - 幸福度 < 20%: **暴乱 (Riots)**。生产完全停止，有人口流失风险。
  - **策略**: 玩家需要在“国库充盈”和“民心稳定”之间寻找动态平衡点。

### 2.2 社会阶级 (Social Classes)

人口不再是通用的“定居者”，而是分化为三个阶级：

1.  **农民 (Peasants)**: 基础阶级。产出 `食物`，提供基础税基。
    - _转化_: Era 1 的所有 Settlers 自动转化为农民。
2.  **工人 (Workers)**: 工业阶级。消耗 `食物`，产出工业原料（矿石、木材）。
3.  **学者 (Scholars)**: 精英阶级。消耗 `食物` + `黄金`，产出 `科学 (Science)`。

### 2.3 产业链 (Industrial Chains)

从“直接采集”升级为“加工制造”。

- **采矿**: 工人开采 `铁矿石 (Iron Ore)`。
- **冶炼**: 冶炼厂消耗 `铁矿石` + `木材` -> 自动产出 `铁锭 (Iron Ingot)`。
- **用途**: 铁锭是建造高级建筑（城堡、军营）和战争机器的基础。

### 2.4 遗留机制 (Legacy Systems from Era 1)

- **季节**: 依然影响农民的农业产出，但对工业影响较小。
- **篝火**: 不再需要手动维护，升级为“城市供暖系统”（自动消耗木材/煤炭）。
- **传统**: 作为一种文化货币保留，用于开启“祭祀/节日”以临时提升幸福度。

---

## 3. 技术架构规范

- **UI 范式**:
  - **Era 1**: 侧重 `Camp` (营地) 面板。
  - **Era 2**: 隐藏 `Camp`，启用 **`City` (城市)** 和 **`Government` (政务)** 面板。
- **状态管理**:
  - `gameSlice`: 管理当前 Era 状态。
  - `populationSlice`: 处理阶级分化与幸福度计算。
  - `economySlice`: (新) 处理税收、黄金流转。
- **数值**: 继续强制使用 `decimal.js`。

---

## 4. 开发路线图 (Roadmap)

### ✅ Phase 1: 部落时代 (已归档)

- 完成所有基础生存、自动化、随机事件与时代终结逻辑。

### 🚀 Phase 2: 王国时代 (进行中)

#### Sprint 2.1: 王权的基石 (已完成/收尾中)

- [x] **时代切换**: 建成部落大厅后无缝进入 Era 2。
- [x] **UI 重构**: 启用 City/Government Tab，隐藏旧面板。
- [x] **阶级系统**: 实现 农民/工人/学者 的分工。
- [x] **税收循环**: 实现 黄金获取 vs 幸福度惩罚。

#### Sprint 2.2: 政策与治理 (下一步)

- [ ] **政策树 (Policies)**: 消耗 `文化` 点数解锁永久国策（如“农奴制” vs “自由民”）。
- [ ] **公共服务**: 建造 `大浴场`、`斗兽场` 等建筑提升基础幸福度，允许更高税率。
- [ ] **行政动荡**: 引入“腐败度”机制，限制无限扩张。

#### Sprint 2.3: 贸易与外交 (Pre-War)

- [ ] **贸易站**: 允许用 黄金/食物 交换稀缺的 铁/石。
- [ ] **邻国接触**: 简单的外交事件（进贡、羞辱），为 Era 3 战争做铺垫。

---

## 5. 待优化项 (Backlog)

1.  **数据可视化**: 王国时代的资源流转复杂（如铁的生产链），需要更清晰的“每秒产出/消耗”Tooltip。
2.  **幸福度反馈**: 暴乱发生时需要更醒目的红色警报。
3.  **转生系统**: 暂缓至 Era 2 后期或 Era 3 瓶颈期实现。
